
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resume Builder Pro</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Lora:wght@400;500;600&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --accent-color: #e74c3c;
            --background-color: #f8f9fa;
            --text-color: #2c3e50;
            --border-color: #e9ecef;
            --success-color: #27ae60;
            --warning-color: #f39c12;
            --error-color: #e74c3c;
            --sidebar-width: 280px;
            --preview-width: 400px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--background-color);
            color: var(--text-color);
            line-height: 1.6;
        }

        /* Layout */
        .app-container {
            display: flex;
            height: 100vh;
            overflow: hidden;
        }

        /* Sidebar */
        .sidebar {
            width: var(--sidebar-width);
            background: white;
            border-right: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            z-index: 1000;
        }

        .sidebar.collapsed {
            transform: translateX(-100%);
        }

        .sidebar-header {
            padding: 20px;
            border-bottom: 1px solid var(--border-color);
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
        }

        .sidebar-header h1 {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .progress-container {
            margin-top: 15px;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(255,255,255,0.2);
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: var(--success-color);
            width: 0%;
            transition: width 0.3s ease;
        }

        .nav-menu {
            flex: 1;
            overflow-y: auto;
        }

        .nav-item {
            padding: 15px 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            border-bottom: 1px solid #f5f5f5;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .nav-item:hover {
            background: #f8f9fa;
            padding-left: 25px;
        }

        .nav-item.active {
            background: linear-gradient(90deg, var(--secondary-color), transparent);
            border-left: 4px solid var(--secondary-color);
            color: var(--secondary-color);
            font-weight: 500;
        }

        .nav-item i {
            width: 20px;
            text-align: center;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* Toolbar */
        .toolbar {
            background: white;
            padding: 15px 20px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        .toolbar-left {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .toolbar-right {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .btn {
            padding: 10px 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
            font-size: 14px;
        }

        .btn-primary {
            background: var(--secondary-color);
            color: white;
        }

        .btn-primary:hover {
            background: #2980b9;
            transform: translateY(-1px);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        .btn-outline {
            background: transparent;
            border: 1px solid var(--border-color);
            color: var(--text-color);
        }

        .btn-outline:hover {
            background: #f8f9fa;
        }

        .mobile-toggle {
            display: none;
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
            color: var(--text-color);
        }

        /* Content Area */
        .content-area {
            flex: 1;
            display: flex;
            overflow: hidden;
        }

        .editor-panel {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            background: white;
            margin: 0 10px 10px 10px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .preview-panel {
            width: var(--preview-width);
            background: white;
            border-left: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .preview-header {
            padding: 15px 20px;
            border-bottom: 1px solid var(--border-color);
            background: #f8f9fa;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .preview-content {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            background: #f0f0f0;
        }

        .resume-preview {
            background: white;
            width: 100%;
            max-width: 350px;
            margin: 0 auto;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            border-radius: 8px;
            overflow: hidden;
            transform: scale(0.85);
            transform-origin: top;
        }

        /* Form Styles */
        .section {
            margin-bottom: 30px;
            opacity: 0;
            transform: translateY(20px);
            animation: fadeInUp 0.5s ease forwards;
        }

        @keyframes fadeInUp {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .section-header {
            display: flex;
            justify-content: between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--secondary-color);
        }

        .section-title {
            font-size: 20px;
            font-weight: 600;
            color: var(--primary-color);
        }

        .section-toggle {
            background: none;
            border: none;
            font-size: 18px;
            cursor: pointer;
            color: var(--secondary-color);
            transition: transform 0.3s ease;
        }

        .section-toggle.collapsed {
            transform: rotate(-90deg);
        }

        .section-content {
            transition: all 0.3s ease;
            overflow: hidden;
        }

        .section-content.collapsed {
            max-height: 0;
            margin: 0;
            opacity: 0;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .form-row.single {
            grid-template-columns: 1fr;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: var(--text-color);
        }

        input, textarea, select {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: var(--secondary-color);
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }

        input.error, textarea.error {
            border-color: var(--error-color);
            box-shadow: 0 0 0 3px rgba(231, 76, 60, 0.1);
        }

        .error-message {
            color: var(--error-color);
            font-size: 12px;
            margin-top: 5px;
            display: none;
        }

        .error-message.show {
            display: block;
        }

        .char-count {
            text-align: right;
            font-size: 12px;
            color: #6c757d;
            margin-top: 5px;
        }

        /* Dynamic Lists */
        .dynamic-list {
            border: 1px solid var(--border-color);
            border-radius: 8px;
            overflow: hidden;
        }

        .list-item {
            padding: 20px;
            border-bottom: 1px solid var(--border-color);
            background: #fafafa;
            position: relative;
            cursor: move;
        }

        .list-item:last-child {
            border-bottom: none;
        }

        .list-item.dragging {
            opacity: 0.5;
            transform: rotate(2deg);
        }

        .item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .item-title {
            font-weight: 600;
            color: var(--primary-color);
        }

        .item-controls {
            display: flex;
            gap: 10px;
        }

        .btn-small {
            padding: 6px 10px;
            font-size: 12px;
            border-radius: 4px;
        }

        .btn-danger {
            background: var(--error-color);
            color: white;
        }

        .btn-danger:hover {
            background: #c0392b;
        }

        .add-item-btn {
            width: 100%;
            padding: 15px;
            border: 2px dashed var(--border-color);
            background: transparent;
            color: var(--secondary-color);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .add-item-btn:hover {
            border-color: var(--secondary-color);
            background: rgba(52, 152, 219, 0.05);
        }

        /* Skills Section */
        .skills-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .skill-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
        }

        .skill-input {
            margin-bottom: 10px;
        }

        .skill-level {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .level-slider {
            flex: 1;
        }

        .level-text {
            font-size: 12px;
            color: #6c757d;
            min-width: 60px;
        }

        /* File Upload */
        .file-upload {
            position: relative;
            display: inline-block;
            cursor: pointer;
            width: 120px;
            height: 120px;
            border: 2px dashed var(--border-color);
            border-radius: 8px;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .file-upload:hover {
            border-color: var(--secondary-color);
        }

        .file-upload input {
            position: absolute;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }

        .upload-placeholder {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            color: #6c757d;
            text-align: center;
            padding: 10px;
        }

        .upload-placeholder i {
            font-size: 24px;
            margin-bottom: 10px;
        }

        .profile-preview {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: none;
        }

        .profile-preview.show {
            display: block;
        }

        /* Template Selection */
        .template-gallery {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .template-card {
            border: 2px solid var(--border-color);
            border-radius: 8px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s ease;
            background: white;
        }

        .template-card:hover {
            border-color: var(--secondary-color);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .template-card.active {
            border-color: var(--secondary-color);
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }

        .template-preview {
            height: 250px;
            background: #f8f9fa;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 48px;
            color: var(--border-color);
        }

        .template-info {
            padding: 15px;
            text-align: center;
        }

        .template-name {
            font-weight: 600;
            margin-bottom: 5px;
        }

        .template-description {
            font-size: 12px;
            color: #6c757d;
        }

        /* Resume Templates */
        .resume-template {
            font-size: 11px;
            line-height: 1.4;
            color: #333;
        }

        /* Classic Template */
        .template-classic {
            font-family: 'Lora', serif;
            padding: 30px;
        }

        .template-classic .resume-header {
            text-align: center;
            margin-bottom: 25px;
            border-bottom: 2px solid #333;
            padding-bottom: 15px;
        }

        .template-classic .resume-name {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .template-classic .resume-contact {
            font-size: 10px;
            color: #666;
        }

        .template-classic .resume-section {
            margin-bottom: 20px;
        }

        .template-classic .section-title {
            font-size: 14px;
            font-weight: 600;
            text-transform: uppercase;
            border-bottom: 1px solid #ccc;
            margin-bottom: 10px;
            padding-bottom: 3px;
        }

        /* Modern Template */
        .template-modern {
            font-family: 'Inter', sans-serif;
            display: grid;
            grid-template-columns: 35% 65%;
            min-height: 400px;
        }

        .template-modern .sidebar {
            background: #2c3e50;
            color: white;
            padding: 25px 20px;
        }

        .template-modern .main {
            padding: 25px 20px;
        }

        .template-modern .resume-name {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .template-modern .resume-title {
            font-size: 12px;
            opacity: 0.8;
            margin-bottom: 20px;
        }

        .template-modern .section-title {
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            margin-bottom: 10px;
            color: #3498db;
        }

        .template-modern .sidebar .section-title {
            color: white;
            border-bottom: 1px solid rgba(255,255,255,0.3);
            padding-bottom: 5px;
        }

        /* Creative Template */
        .template-creative {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            position: relative;
        }

        .template-creative::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 60px;
            background: rgba(255,255,255,0.1);
        }

        .template-creative .resume-header {
            position: relative;
            z-index: 1;
            margin-bottom: 25px;
        }

        .template-creative .resume-name {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .template-creative .section-title {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 10px;
            position: relative;
        }

        .template-creative .section-title::after {
            content: '';
            position: absolute;
            bottom: -3px;
            left: 0;
            width: 30px;
            height: 2px;
            background: rgba(255,255,255,0.8);
        }

        /* Common resume styles */
        .resume-item {
            margin-bottom: 12px;
        }

        .item-title {
            font-weight: 600;
            margin-bottom: 2px;
        }

        .item-subtitle {
            font-style: italic;
            opacity: 0.8;
            margin-bottom: 3px;
        }

        .item-date {
            font-size: 9px;
            opacity: 0.7;
        }

        .item-description {
            margin-top: 5px;
        }

        .item-description ul {
            margin-left: 15px;
        }

        .item-description li {
            margin-bottom: 2px;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            :root {
                --sidebar-width: 250px;
                --preview-width: 100%;
            }

            .mobile-toggle {
                display: block;
            }

            .content-area {
                flex-direction: column;
            }

            .preview-panel {
                width: 100%;
                border-left: none;
                border-top: 1px solid var(--border-color);
                max-height: 50vh;
            }

            .toolbar {
                flex-wrap: wrap;
                gap: 10px;
            }

            .toolbar-left,
            .toolbar-right {
                gap: 10px;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .skills-container {
                grid-template-columns: 1fr;
            }

            .template-gallery {
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            }

            .resume-preview {
                transform: scale(0.7);
            }
        }

        @media (max-width: 480px) {
            .app-container {
                flex-direction: column;
            }

            .sidebar {
                position: fixed;
                top: 0;
                left: 0;
                height: 100vh;
                z-index: 1000;
            }

            .sidebar.collapsed {
                transform: translateX(-100%);
            }

            .main-content {
                width: 100%;
            }

            .toolbar {
                padding: 10px;
            }

            .editor-panel {
                margin: 0;
                border-radius: 0;
            }

            .preview-panel {
                max-height: 40vh;
            }
        }

        /* Animations and Transitions */
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .slide-in {
            animation: slideIn 0.3s ease-out;
        }

        @keyframes slideIn {
            from { transform: translateX(-20px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        /* Tooltip */
        .tooltip {
            position: relative;
            cursor: help;
        }

        .tooltip::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            background: #333;
            color: white;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 12px;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .tooltip:hover::after {
            opacity: 1;
            visibility: visible;
        }

        /* Loading states */
        .loading {
            opacity: 0.6;
            pointer-events: none;
        }

        .spinner {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 2px solid #f3f3f3;
            border-top: 2px solid var(--secondary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <div class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <h1><i class="fas fa-file-alt"></i> Resume Builder</h1>
                <p>Create your perfect resume</p>
                <div class="progress-container">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                    <small id="progressText">0% Complete</small>
                </div>
            </div>
            
            <nav class="nav-menu">
                <div class="nav-item active" data-section="personal">
                    <i class="fas fa-user"></i>
                    <span>Personal Info</span>
                </div>
                <div class="nav-item" data-section="summary">
                    <i class="fas fa-quote-left"></i>
                    <span>Summary</span>
                </div>
                <div class="nav-item" data-section="experience">
                    <i class="fas fa-briefcase"></i>
                    <span>Experience</span>
                </div>
                <div class="nav-item" data-section="education">
                    <i class="fas fa-graduation-cap"></i>
                    <span>Education</span>
                </div>
                <div class="nav-item" data-section="skills">
                    <i class="fas fa-cogs"></i>
                    <span>Skills</span>
                </div>
                <div class="nav-item" data-section="templates">
                    <i class="fas fa-palette"></i>
                    <span>Templates</span>
                </div>
            </nav>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Toolbar -->
            <div class="toolbar">
                <div class="toolbar-left">
                    <button class="mobile-toggle" id="mobileToggle">
                        <i class="fas fa-bars"></i>
                    </button>
                    <h2 id="sectionTitle">Personal Information</h2>
                </div>
                <div class="toolbar-right">
                    <button class="btn btn-outline" id="loadSampleBtn">
                        <i class="fas fa-magic"></i>
                        Load Sample
                    </button>
                    <button class="btn btn-secondary" id="exportHtmlBtn">
                        <i class="fas fa-code"></i>
                        Export HTML
                    </button>
                    <button class="btn btn-primary" id="exportPdfBtn">
                        <i class="fas fa-download"></i>
                        Export PDF
                    </button>
                </div>
            </div>

            <!-- Content Area -->
            <div class="content-area">
                <!-- Editor Panel -->
                <div class="editor-panel">
                    <div id="editorContent">
                        <!-- Content will be dynamically loaded here -->
                    </div>
                </div>

                <!-- Preview Panel -->
                <div class="preview-panel">
                    <div class="preview-header">
                        <h3>Live Preview</h3>
                        <select id="templateSelector" class="btn btn-outline">
                            <option value="classic">Classic</option>
                            <option value="modern">Modern</option>
                            <option value="creative">Creative</option>
                        </select>
                    </div>
                    <div class="preview-content">
                        <div class="resume-preview">
                            <div id="resumePreview" class="resume-template template-classic">
                                <!-- Resume preview will be generated here -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Application State
        const state = {
            currentSection: 'personal',
            currentTemplate: 'classic',
            data: {
                personal: {
                    name: '',
                    email: '',
                    phone: '',
                    linkedin: '',
                    github: '',
                    photo: null
                },
                summary: {
                    text: ''
                },
                experience: [],
                education: [],
                skills: []
            }
        };

        // Templates for sections
        const sectionTemplates = {
            personal: `
                <div class="section fade-in">
                    <div class="section-header">
                        <h2 class="section-title">Personal Information</h2>
                        <button class="section-toggle" onclick="toggleSection(this)">
                            <i class="fas fa-chevron-down"></i>
                        </button>
                    </div>
                    <div class="section-content">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="name">Full Name *</label>
                                <input type="text" id="name" placeholder="John Doe" required>
                                <div class="error-message">Please enter your full name</div>
                            </div>
                            <div class="form-group">
                                <label for="email">Email Address *</label>
                                <input type="email" id="email" placeholder="john@example.com" required>
                                <div class="error-message">Please enter a valid email address</div>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="phone">Phone Number</label>
                                <input type="tel" id="phone" placeholder="+1 (555) 123-4567">
                            </div>
                            <div class="form-group">
                                <label for="linkedin">LinkedIn Profile</label>
                                <input type="url" id="linkedin" placeholder="https://linkedin.com/in/johndoe">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="github">GitHub Profile</label>
                                <input type="url" id="github" placeholder="https://github.com/johndoe">
                            </div>
                            <div class="form-group">
                                <label>Profile Photo</label>
                                <div class="file-upload" onclick="document.getElementById('photoUpload').click()">
                                    <input type="file" id="photoUpload" accept="image/*" onchange="handlePhotoUpload(event)">
                                    <div class="upload-placeholder">
                                        <i class="fas fa-camera"></i>
                                        <small>Upload Photo</small>
                                    </div>
                                    <img id="photoPreview" class="profile-preview" alt="Profile Preview">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `,
            summary: `
                <div class="section fade-in">
                    <div class="section-header">
                        <h2 class="section-title">Professional Summary</h2>
                        <button class="section-toggle" onclick="toggleSection(this)">
                            <i class="fas fa-chevron-down"></i>
                        </button>
                    </div>
                    <div class="section-content">
                        <div class="form-group">
                            <label for="summary">Professional Summary 
                                <span class="tooltip" data-tooltip="Write 2-3 sentences highlighting your key achievements and skills">
                                    <i class="fas fa-question-circle"></i>
                                </span>
                            </label>
                            <textarea id="summary" rows="4" maxlength="300" placeholder="Experienced software developer with 5+ years of experience in full-stack development..."></textarea>
                            <div class="char-count"><span id="summaryCount">0</span>/300 characters</div>
                        </div>
                        <button class="btn btn-outline" onclick="generateSummary()">
                            <i class="fas fa-magic"></i>
                            AI Suggestion
                        </button>
                    </div>
                </div>
            `,
            experience: `
                <div class="section fade-in">
                    <div class="section-header">
                        <h2 class="section-title">Work Experience</h2>
                        <button class="section-toggle" onclick="toggleSection(this)">
                            <i class="fas fa-chevron-down"></i>
                        </button>
                    </div>
                    <div class="section-content">
                        <div id="experienceList" class="dynamic-list">
                            <!-- Experience items will be added here -->
                        </div>
                        <button class="add-item-btn" onclick="addExperience()">
                            <i class="fas fa-plus"></i>
                            Add Work Experience
                        </button>
                    </div>
                </div>
            `,
            education: `
                <div class="section fade-in">
                    <div class="section-header">
                        <h2 class="section-title">Education</h2>
                        <button class="section-toggle" onclick="toggleSection(this)">
                            <i class="fas fa-chevron-down"></i>
                        </button>
                    </div>
                    <div class="section-content">
                        <div id="educationList" class="dynamic-list">
                            <!-- Education items will be added here -->
                        </div>
                        <button class="add-item-btn" onclick="addEducation()">
                            <i class="fas fa-plus"></i>
                            Add Education
                        </button>
                    </div>
                </div>
            `,
            skills: `
                <div class="section fade-in">
                    <div class="section-header">
                        <h2 class="section-title">Skills</h2>
                        <button class="section-toggle" onclick="toggleSection(this)">
                            <i class="fas fa-chevron-down"></i>
                        </button>
                    </div>
                    <div class="section-content">
                        <div id="skillsList" class="skills-container">
                            <!-- Skills will be added here -->
                        </div>
                        <button class="add-item-btn" onclick="addSkill()">
                            <i class="fas fa-plus"></i>
                            Add Skill
                        </button>
                    </div>
                </div>
            `,
            templates: `
                <div class="section fade-in">
                    <div class="section-header">
                        <h2 class="section-title">Choose Template</h2>
                        <button class="section-toggle" onclick="toggleSection(this)">
                            <i class="fas fa-chevron-down"></i>
                        </button>
                    </div>
                    <div class="section-content">
                        <div class="template-gallery">
                            <div class="template-card active" data-template="classic">
                                <div class="template-preview">
                                    <i class="fas fa-file-alt"></i>
                                </div>
                                <div class="template-info">
                                    <div class="template-name">Classic</div>
                                    <div class="template-description">Traditional single-column layout with serif fonts</div>
                                </div>
                            </div>
                            <div class="template-card" data-template="modern">
                                <div class="template-preview">
                                    <i class="fas fa-th-large"></i>
                                </div>
                                <div class="template-info">
                                    <div class="template-name">Modern</div>
                                    <div class="template-description">Two-column layout with clean typography</div>
                                </div>
                            </div>
                            <div class="template-card" data-template="creative">
                                <div class="template-preview">
                                    <i class="fas fa-paint-brush"></i>
                                </div>
                                <div class="template-info">
                                    <div class="template-name">Creative</div>
                                    <div class="template-description">Bold design with gradient backgrounds</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `
        };

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            loadSection('personal');
            updatePreview();
            loadFromStorage();
            setupEventListeners();
        });

        function setupEventListeners() {
            // Navigation
            document.querySelectorAll('.nav-item').forEach(item => {
                item.addEventListener('click', () => {
                    const section = item.dataset.section;
                    loadSection(section);
                });
            });

            // Mobile toggle
            document.getElementById('mobileToggle').addEventListener('click', () => {
                document.getElementById('sidebar').classList.toggle('collapsed');
            });

            // Template selector
            document.getElementById('templateSelector').addEventListener('change', (e) => {
                changeTemplate(e.target.value);
            });

            // Export buttons
            document.getElementById('exportPdfBtn').addEventListener('click', exportToPDF);
            document.getElementById('exportHtmlBtn').addEventListener('click', exportToHTML);
            document.getElementById('loadSampleBtn').addEventListener('click', loadSampleData);

            // Auto-save
            setInterval(saveToStorage, 30000); // Save every 30 seconds
        }

        function loadSection(sectionName) {
            // Update navigation
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
                if (item.dataset.section === sectionName) {
                    item.classList.add('active');
                }
            });

            // Update section title
            const titles = {
                personal: 'Personal Information',
                summary: 'Professional Summary',
                experience: 'Work Experience',
                education: 'Education',
                skills: 'Skills',
                templates: 'Templates'
            };
            document.getElementById('sectionTitle').textContent = titles[sectionName];

            // Load section content
            const content = document.getElementById('editorContent');
            content.innerHTML = sectionTemplates[sectionName];

            // Set current section
            state.currentSection = sectionName;

            // Load existing data
            loadSectionData(sectionName);

            // Setup section-specific event listeners
            setupSectionListeners(sectionName);
        }

        function loadSectionData(sectionName) {
            switch(sectionName) {
                case 'personal':
                    const personal = state.data.personal;
                    document.getElementById('name').value = personal.name || '';
                    document.getElementById('email').value = personal.email || '';
                    document.getElementById('phone').value = personal.phone || '';
                    document.getElementById('linkedin').value = personal.linkedin || '';
                    document.getElementById('github').value = personal.github || '';
                    if (personal.photo) {
                        const preview = document.getElementById('photoPreview');
                        preview.src = personal.photo;
                        preview.classList.add('show');
                        document.querySelector('.upload-placeholder').style.display = 'none';
                    }
                    break;
                case 'summary':
                    document.getElementById('summary').value = state.data.summary.text || '';
                    updateCharCount();
                    break;
                case 'experience':
                    renderExperienceList();
                    break;
                case 'education':
                    renderEducationList();
                    break;
                case 'skills':
                    renderSkillsList();
                    break;
                case 'templates':
                    setupTemplateSelection();
                    break;
            }
        }

        function setupSectionListeners(sectionName) {
            switch(sectionName) {
                case 'personal':
                    ['name', 'email', 'phone', 'linkedin', 'github'].forEach(field => {
                        const element = document.getElementById(field);
                        if (element) {
                            element.addEventListener('input', (e) => {
                                state.data.personal[field] = e.target.value;
                                validateField(element);
                                updatePreview();
                                updateProgress();
                            });
                        }
                    });
                    break;
                case 'summary':
                    const summaryField = document.getElementById('summary');
                    if (summaryField) {
                        summaryField.addEventListener('input', (e) => {
                            state.data.summary.text = e.target.value;
                            updateCharCount();
                            updatePreview();
                            updateProgress();
                        });
                    }
                    break;
            }
        }

        function validateField(element) {
            const value = element.value.trim();
            const type = element.type;
            let isValid = true;
            let errorMsg = '';

            if (element.required && !value) {
                isValid = false;
                errorMsg = 'This field is required';
            } else if (type === 'email' && value && !isValidEmail(value)) {
                isValid = false;
                errorMsg = 'Please enter a valid email address';
            } else if (type === 'url' && value && !isValidURL(value)) {
                isValid = false;
                errorMsg = 'Please enter a valid URL';
            }

            const errorElement = element.nextElementSibling;
            if (errorElement && errorElement.classList.contains('error-message')) {
                if (isValid) {
                    element.classList.remove('error');
                    errorElement.classList.remove('show');
                } else {
                    element.classList.add('error');
                    errorElement.textContent = errorMsg;
                    errorElement.classList.add('show');
                }
            }

            return isValid;
        }

        function isValidEmail(email) {
            return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
        }

        function isValidURL(url) {
            try {
                new URL(url);
                return true;
            } catch {
                return false;
            }
        }

        function updateCharCount() {
            const summaryField = document.getElementById('summary');
            const countElement = document.getElementById('summaryCount');
            if (summaryField && countElement) {
                countElement.textContent = summaryField.value.length;
            }
        }

        function handlePhotoUpload(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    const preview = document.getElementById('photoPreview');
                    preview.src = e.target.result;
                    preview.classList.add('show');
                    document.querySelector('.upload-placeholder').style.display = 'none';
                    
                    state.data.personal.photo = e.target.result;
                    updatePreview();
                    updateProgress();
                };
                reader.readAsDataURL(file);
            }
        }

        function toggleSection(button) {
            const content = button.closest('.section').querySelector('.section-content');
            const icon = button.querySelector('i');
            
            if (content.classList.contains('collapsed')) {
                content.classList.remove('collapsed');
                icon.classList.remove('fa-chevron-right');
                icon.classList.add('fa-chevron-down');
            } else {
                content.classList.add('collapsed');
                icon.classList.remove('fa-chevron-down');
                icon.classList.add('fa-chevron-right');
            }
        }

        function generateSummary() {
            const suggestions = [
                "Experienced professional with a proven track record of delivering high-quality results in fast-paced environments. Strong analytical and problem-solving skills with excellent communication abilities.",
                "Results-driven individual with expertise in project management and team leadership. Committed to continuous learning and innovation to drive organizational success.",
                "Detail-oriented professional with strong technical skills and a passion for excellence. Proven ability to work collaboratively and independently to achieve goals."
            ];
            
            const randomSuggestion = suggestions[Math.floor(Math.random() * suggestions.length)];
            document.getElementById('summary').value = randomSuggestion;
            state.data.summary.text = randomSuggestion;
            updateCharCount();
            updatePreview();
            updateProgress();
        }

        // Experience Management
        function addExperience() {
            const experience = {
                id: Date.now(),
                title: '',
                company: '',
                startDate: '',
                endDate: '',
                current: false,
                description: '',
                bullets: ['']
            };
            
            state.data.experience.push(experience);
            renderExperienceList();
            updatePreview();
            updateProgress();
        }

        function removeExperience(id) {
            state.data.experience = state.data.experience.filter(exp => exp.id !== id);
            renderExperienceList();
            updatePreview();
            updateProgress();
        }

        function renderExperienceList() {
            const container = document.getElementById('experienceList');
            if (!container) return;

            container.innerHTML = '';

            state.data.experience.forEach((exp, index) => {
                const item = document.createElement('div');
                item.className = 'list-item';
                item.draggable = true;
                item.dataset.index = index;
                
                item.innerHTML = `
                    <div class="item-header">
                        <div class="item-title">${exp.title || 'New Position'}</div>
                        <div class="item-controls">
                            <button class="btn btn-danger btn-small" onclick="removeExperience(${exp.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Job Title</label>
                            <input type="text" value="${exp.title}" onchange="updateExperience(${exp.id}, 'title', this.value)" placeholder="Software Developer">
                        </div>
                        <div class="form-group">
                            <label>Company</label>
                            <input type="text" value="${exp.company}" onchange="updateExperience(${exp.id}, 'company', this.value)" placeholder="Tech Corp">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Start Date</label>
                            <input type="month" value="${exp.startDate}" onchange="updateExperience(${exp.id}, 'startDate', this.value)">
                        </div>
                        <div class="form-group">
                            <label>End Date</label>
                            <input type="month" value="${exp.endDate}" onchange="updateExperience(${exp.id}, 'endDate', this.value)" ${exp.current ? 'disabled' : ''}>
                            <label style="margin-top: 5px;">
                                <input type="checkbox" ${exp.current ? 'checked' : ''} onchange="updateExperience(${exp.id}, 'current', this.checked)"> Currently work here
                            </label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea rows="3" onchange="updateExperience(${exp.id}, 'description', this.value)" placeholder="Describe your role and achievements...">${exp.description}</textarea>
                    </div>
                    <div class="form-group">
                        <label>Key Achievements (bullet points)</label>
                        <div id="bullets-${exp.id}">
                            ${exp.bullets.map((bullet, i) => `
                                <div style="display: flex; gap: 10px; margin-bottom: 10px;">
                                    <input type="text" value="${bullet}" onchange="updateBullet(${exp.id}, ${i}, this.value)" placeholder="• Achieved 20% increase in productivity..." style="flex: 1;">
                                    <button class="btn btn-danger btn-small" onclick="removeBullet(${exp.id}, ${i})">
                                        <i class="fas fa-times"></i>
                                    </button>
                                </div>
                            `).join('')}
                        </div>
                        <button class="btn btn-outline btn-small" onclick="addBullet(${exp.id})" style="margin-top: 10px;">
                            <i class="fas fa-plus"></i> Add Bullet Point
                        </button>
                    </div>
                `;
                
                container.appendChild(item);
            });

            setupDragAndDrop(container, 'experience');
        }

        function updateExperience(id, field, value) {
            const experience = state.data.experience.find(exp => exp.id === id);
            if (experience) {
                experience[field] = value;
                updatePreview();
                updateProgress();
                
                if (field === 'current') {
                    renderExperienceList(); // Re-render to update date field state
                }
            }
        }

        function addBullet(expId) {
            const experience = state.data.experience.find(exp => exp.id === expId);
            if (experience) {
                experience.bullets.push('');
                renderExperienceList();
            }
        }

        function removeBullet(expId, bulletIndex) {
            const experience = state.data.experience.find(exp => exp.id === expId);
            if (experience && experience.bullets.length > 1) {
                experience.bullets.splice(bulletIndex, 1);
                renderExperienceList();
                updatePreview();
            }
        }

        function updateBullet(expId, bulletIndex, value) {
            const experience = state.data.experience.find(exp => exp.id === expId);
            if (experience) {
                experience.bullets[bulletIndex] = value;
                updatePreview();
            }
        }

        // Education Management
        function addEducation() {
            const education = {
                id: Date.now(),
                degree: '',
                institution: '',
                year: '',
                gpa: '',
                showGpa: false
            };
            
            state.data.education.push(education);
            renderEducationList();
            updatePreview();
            updateProgress();
        }

        function removeEducation(id) {
            state.data.education = state.data.education.filter(edu => edu.id !== id);
            renderEducationList();
            updatePreview();
            updateProgress();
        }

        function renderEducationList() {
            const container = document.getElementById('educationList');
            if (!container) return;

            container.innerHTML = '';

            state.data.education.forEach((edu, index) => {
                const item = document.createElement('div');
                item.className = 'list-item';
                item.draggable = true;
                item.dataset.index = index;
                
                item.innerHTML = `
                    <div class="item-header">
                        <div class="item-title">${edu.degree || 'New Education'}</div>
                        <div class="item-controls">
                            <button class="btn btn-danger btn-small" onclick="removeEducation(${edu.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Degree</label>
                            <input type="text" value="${edu.degree}" onchange="updateEducation(${edu.id}, 'degree', this.value)" placeholder="Bachelor of Science">
                        </div>
                        <div class="form-group">
                            <label>Institution</label>
                            <input type="text" value="${edu.institution}" onchange="updateEducation(${edu.id}, 'institution', this.value)" placeholder="University Name">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Year</label>
                            <input type="number" value="${edu.year}" onchange="updateEducation(${edu.id}, 'year', this.value)" placeholder="2023" min="1950" max="2030">
                        </div>
                        <div class="form-group">
                            <label>GPA</label>
                            <input type="number" value="${edu.gpa}" onchange="updateEducation(${edu.id}, 'gpa', this.value)" placeholder="3.8" min="0" max="4" step="0.1" ${!edu.showGpa ? 'disabled' : ''}>
                            <label style="margin-top: 5px;">
                                <input type="checkbox" ${edu.showGpa ? 'checked' : ''} onchange="updateEducation(${edu.id}, 'showGpa', this.checked)"> Include GPA
                            </label>
                        </div>
                    </div>
                `;
                
                container.appendChild(item);
            });

            setupDragAndDrop(container, 'education');
        }

        function updateEducation(id, field, value) {
            const education = state.data.education.find(edu => edu.id === id);
            if (education) {
                education[field] = value;
                updatePreview();
                updateProgress();
                
                if (field === 'showGpa') {
                    renderEducationList(); // Re-render to update GPA field state
                }
            }
        }

        // Skills Management
        function addSkill() {
            const skill = {
                id: Date.now(),
                name: '',
                level: 3
            };
            
            state.data.skills.push(skill);
            renderSkillsList();
            updatePreview();
            updateProgress();
        }

        function removeSkill(id) {
            state.data.skills = state.data.skills.filter(skill => skill.id !== id);
            renderSkillsList();
            updatePreview();
            updateProgress();
        }

        function renderSkillsList() {
            const container = document.getElementById('skillsList');
            if (!container) return;

            container.innerHTML = '';

            state.data.skills.forEach(skill => {
                const item = document.createElement('div');
                item.className = 'skill-item';
                
                const levelLabels = ['Beginner', 'Novice', 'Intermediate', 'Advanced', 'Expert'];
                
                item.innerHTML = `
                    <div class="skill-input">
                        <input type="text" value="${skill.name}" onchange="updateSkill(${skill.id}, 'name', this.value)" placeholder="JavaScript">
                        <button class="btn btn-danger btn-small" onclick="removeSkill(${skill.id})" style="float: right;">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="skill-level">
                        <input type="range" class="level-slider" min="1" max="5" value="${skill.level}" onchange="updateSkill(${skill.id}, 'level', parseInt(this.value))">
                        <span class="level-text">${levelLabels[skill.level - 1]}</span>
                    </div>
                `;
                
                container.appendChild(item);
            });
        }

        function updateSkill(id, field, value) {
            const skill = state.data.skills.find(s => s.id === id);
            if (skill) {
                skill[field] = value;
                updatePreview();
                updateProgress();
                
                if (field === 'level') {
                    renderSkillsList(); // Re-render to update level display
                }
            }
        }

        // Template Management
        function setupTemplateSelection() {
            document.querySelectorAll('.template-card').forEach(card => {
                card.addEventListener('click', () => {
                    const template = card.dataset.template;
                    selectTemplate(template);
                });
            });
        }

        function selectTemplate(templateName) {
            document.querySelectorAll('.template-card').forEach(card => {
                card.classList.remove('active');
                if (card.dataset.template === templateName) {
                    card.classList.add('active');
                }
            });
            
            changeTemplate(templateName);
        }

        function changeTemplate(templateName) {
            state.currentTemplate = templateName;
            document.getElementById('templateSelector').value = templateName;
            updatePreview();
        }

        // Drag and Drop
        function setupDragAndDrop(container, type) {
            let draggedElement = null;

            container.addEventListener('dragstart', (e) => {
                draggedElement = e.target.closest('.list-item');
                if (draggedElement) {
                    draggedElement.classList.add('dragging');
                }
            });

            container.addEventListener('dragend', (e) => {
                if (draggedElement) {
                    draggedElement.classList.remove('dragging');
                    draggedElement = null;
                }
            });

            container.addEventListener('dragover', (e) => {
                e.preventDefault();
                const afterElement = getDragAfterElement(container, e.clientY);
                if (draggedElement && afterElement == null) {
                    container.appendChild(draggedElement);
                } else if (draggedElement) {
                    container.insertBefore(draggedElement, afterElement);
                }
            });

            container.addEventListener('drop', (e) => {
                e.preventDefault();
                reorderItems(type);
            });
        }

        function getDragAfterElement(container, y) {
            const draggableElements = [...container.querySelectorAll('.list-item:not(.dragging)')];
            
            return draggableElements.reduce((closest, child) => {
                const box = child.getBoundingClientRect();
                const offset = y - box.top - box.height / 2;
                
                if (offset < 0 && offset > closest.offset) {
                    return { offset: offset, element: child };
                } else {
                    return closest;
                }
            }, { offset: Number.NEGATIVE_INFINITY }).element;
        }

        function reorderItems(type) {
            const container = document.getElementById(type + 'List');
            const items = [...container.querySelectorAll('.list-item')];
            const newOrder = [];
            
            items.forEach(item => {
                const index = parseInt(item.dataset.index);
                newOrder.push(state.data[type][index]);
            });
            
            state.data[type] = newOrder;
            updatePreview();
        }

        // Preview Generation
        function updatePreview() {
            const preview = document.getElementById('resumePreview');
            preview.className = `resume-template template-${state.currentTemplate}`;
            
            switch(state.currentTemplate) {
                case 'classic':
                    preview.innerHTML = generateClassicTemplate();
                    break;
                case 'modern':
                    preview.innerHTML = generateModernTemplate();
                    break;
                case 'creative':
                    preview.innerHTML = generateCreativeTemplate();
                    break;
            }
        }

        function generateClassicTemplate() {
            const { personal, summary, experience, education, skills } = state.data;
            
            return `
                <div class="resume-header">
                    <div class="resume-name">${personal.name || 'Your Name'}</div>
                    <div class="resume-contact">
                        ${personal.email || 'email@example.com'} ${personal.phone ? '• ' + personal.phone : ''} 
                        ${personal.linkedin ? '• LinkedIn' : ''} ${personal.github ? '• GitHub' : ''}
                    </div>
                </div>
                
                ${summary.text ? `
                    <div class="resume-section">
                        <div class="section-title">Professional Summary</div>
                        <p>${summary.text}</p>
                    </div>
                ` : ''}
                
                ${experience.length ? `
                    <div class="resume-section">
                        <div class="section-title">Work Experience</div>
                        ${experience.map(exp => `
                            <div class="resume-item">
                                <div class="item-title">${exp.title}</div>
                                <div class="item-subtitle">${exp.company}</div>
                                <div class="item-date">${formatDate(exp.startDate)} - ${exp.current ? 'Present' : formatDate(exp.endDate)}</div>
                                ${exp.description ? `<div class="item-description">${exp.description}</div>` : ''}
                                ${exp.bullets.filter(b => b).length ? `
                                    <div class="item-description">
                                        <ul>
                                            ${exp.bullets.filter(b => b).map(bullet => `<li>${bullet}</li>`).join('')}
                                        </ul>
                                    </div>
                                ` : ''}
                            </div>
                        `).join('')}
                    </div>
                ` : ''}
                
                ${education.length ? `
                    <div class="resume-section">
                        <div class="section-title">Education</div>
                        ${education.map(edu => `
                            <div class="resume-item">
                                <div class="item-title">${edu.degree}</div>
                                <div class="item-subtitle">${edu.institution}</div>
                                <div class="item-date">${edu.year}${edu.showGpa && edu.gpa ? ` • GPA: ${edu.gpa}` : ''}</div>
                            </div>
                        `).join('')}
                    </div>
                ` : ''}
                
                ${skills.length ? `
                    <div class="resume-section">
                        <div class="section-title">Skills</div>
                        <div>${skills.map(skill => skill.name).filter(name => name).join(' • ')}</div>
                    </div>
                ` : ''}
            `;
        }

        function generateModernTemplate() {
            const { personal, summary, experience, education, skills } = state.data;
            
            return `
                <div class="sidebar">
                    <div class="resume-header">
                        <div class="resume-name">${personal.name || 'Your Name'}</div>
                        <div class="resume-title">Professional</div>
                    </div>
                    
                    <div class="resume-section">
                        <div class="section-title">Contact</div>
                        <div style="font-size: 9px; line-height: 1.4;">
                            ${personal.email || 'email@example.com'}<br>
                            ${personal.phone || ''}<br>
                            ${personal.linkedin ? 'LinkedIn Profile<br>' : ''}
                            ${personal.github ? 'GitHub Profile' : ''}
                        </div>
                    </div>
                    
                    ${skills.length ? `
                        <div class="resume-section">
                            <div class="section-title">Skills</div>
                            <div style="font-size: 9px;">
                                ${skills.map(skill => skill.name).filter(name => name).join('<br>')}
                            </div>
                        </div>
                    ` : ''}
                </div>
                
                <div class="main">
                    ${summary.text ? `
                        <div class="resume-section">
                            <div class="section-title">Professional Summary</div>
                            <p style="font-size: 10px;">${summary.text}</p>
                        </div>
                    ` : ''}
                    
                    ${experience.length ? `
                        <div class="resume-section">
                            <div class="section-title">Work Experience</div>
                            ${experience.map(exp => `
                                <div class="resume-item">
                                    <div class="item-title">${exp.title}</div>
                                    <div class="item-subtitle">${exp.company}</div>
                                    <div class="item-date">${formatDate(exp.startDate)} - ${exp.current ? 'Present' : formatDate(exp.endDate)}</div>
                                    ${exp.description ? `<div class="item-description">${exp.description}</div>` : ''}
                                    ${exp.bullets.filter(b => b).length ? `
                                        <div class="item-description">
                                            <ul>
                                                ${exp.bullets.filter(b => b).map(bullet => `<li>${bullet}</li>`).join('')}
                                            </ul>
                                        </div>
                                    ` : ''}
                                </div>
                            `).join('')}
                        </div>
                    ` : ''}
                    
                    ${education.length ? `
                        <div class="resume-section">
                            <div class="section-title">Education</div>
                            ${education.map(edu => `
                                <div class="resume-item">
                                    <div class="item-title">${edu.degree}</div>
                                    <div class="item-subtitle">${edu.institution}</div>
                                    <div class="item-date">${edu.year}${edu.showGpa && edu.gpa ? ` • GPA: ${edu.gpa}` : ''}</div>
                                </div>
                            `).join('')}
                        </div>
                    ` : ''}
                </div>
            `;
        }

        function generateCreativeTemplate() {
            const { personal, summary, experience, education, skills } = state.data;
            
            return `
                <div class="resume-header">
                    <div class="resume-name">${personal.name || 'Your Name'}</div>
                    <div style="font-size: 11px; opacity: 0.9;">
                        ${personal.email || 'email@example.com'} ${personal.phone ? '• ' + personal.phone : ''}
                    </div>
                </div>
                
                ${summary.text ? `
                    <div class="resume-section">
                        <div class="section-title">About</div>
                        <p>${summary.text}</p>
                    </div>
                ` : ''}
                
                ${experience.length ? `
                    <div class="resume-section">
                        <div class="section-title">Experience</div>
                        ${experience.map(exp => `
                            <div class="resume-item">
                                <div class="item-title">${exp.title}</div>
                                <div class="item-subtitle">${exp.company}</div>
                                <div class="item-date">${formatDate(exp.startDate)} - ${exp.current ? 'Present' : formatDate(exp.endDate)}</div>
                                ${exp.description ? `<div class="item-description">${exp.description}</div>` : ''}
                                ${exp.bullets.filter(b => b).length ? `
                                    <div class="item-description">
                                        <ul>
                                            ${exp.bullets.filter(b => b).map(bullet => `<li>${bullet}</li>`).join('')}
                                        </ul>
                                    </div>
                                ` : ''}
                            </div>
                        `).join('')}
                    </div>
                ` : ''}
                
                ${education.length ? `
                    <div class="resume-section">
                        <div class="section-title">Education</div>
                        ${education.map(edu => `
                            <div class="resume-item">
                                <div class="item-title">${edu.degree}</div>
                                <div class="item-subtitle">${edu.institution}</div>
                                <div class="item-date">${edu.year}${edu.showGpa && edu.gpa ? ` • GPA: ${edu.gpa}` : ''}</div>
                            </div>
                        `).join('')}
                    </div>
                ` : ''}
                
                ${skills.length ? `
                    <div class="resume-section">
                        <div class="section-title">Skills</div>
                        <div>${skills.map(skill => skill.name).filter(name => name).join(' • ')}</div>
                    </div>
                ` : ''}
            `;
        }

        function formatDate(dateString) {
            if (!dateString) return '';
            const date = new Date(dateString + '-01');
            return date.toLocaleDateString('en-US', { year: 'numeric', month: 'short' });
        }

        // Progress Tracking
        function updateProgress() {
            const { personal, summary, experience, education, skills } = state.data;
            let completed = 0;
            let total = 5;

            // Personal info (required fields)
            if (personal.name && personal.email) completed++;
            
            // Summary
            if (summary.text && summary.text.length > 50) completed++;
            
            // Experience
            if (experience.length > 0 && experience[0].title && experience[0].company) completed++;
            
            // Education
            if (education.length > 0 && education[0].degree && education[0].institution) completed++;
            
            // Skills
            if (skills.length > 0 && skills[0].name) completed++;

            const percentage = Math.round((completed / total) * 100);
            document.getElementById('progressFill').style.width = percentage + '%';
            document.getElementById('progressText').textContent = percentage + '% Complete';
        }

        // Export Functions
        function exportToPDF() {
            const { jsPDF } = window.jspdf;
            const pdf = new jsPDF();
            
            // Get the resume content
            const resumeElement = document.getElementById('resumePreview');
            const content = resumeElement.innerHTML;
            
            // Create a temporary div with better styling for PDF
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = content;
            tempDiv.style.cssText = `
                font-family: Arial, sans-serif;
                font-size: 12px;
                line-height: 1.4;
                color: #333;
                width: 190mm;
                padding: 10mm;
            `;
            
            document.body.appendChild(tempDiv);
            
            // Convert to PDF
            pdf.html(tempDiv, {
                callback: function (doc) {
                    doc.save(`${state.data.personal.name || 'resume'}.pdf`);
                    document.body.removeChild(tempDiv);
                },
                x: 10,
                y: 10,
                width: 190,
                windowWidth: 800
            });
        }

        function exportToHTML() {
            const resumeElement = document.getElementById('resumePreview');
            const html = `
                <!DOCTYPE html>
                <html lang="en">
                <head>
                    <meta charset="UTF-8">
                    <meta name="viewport" content="width=device-width, initial-scale=1.0">
                    <title>${state.data.personal.name || 'Resume'}</title>
                    <style>
                        body { font-family: Arial, sans-serif; margin: 40px; line-height: 1.6; }
                        .resume-template { max-width: 800px; margin: 0 auto; }
                        ${getTemplateCSS()}
                    </style>
                </head>
                <body>
                    <div class="resume-template template-${state.currentTemplate}">
                        ${resumeElement.innerHTML}
                    </div>
                </body>
                </html>
            `;
            
            const blob = new Blob([html], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${state.data.personal.name || 'resume'}.html`;
            a.click();
            URL.revokeObjectURL(url);
        }

        function getTemplateCSS() {
            // Return CSS specific to current template
            const css = {
                classic: `
                    .template-classic { font-family: Georgia, serif; }
                    .resume-header { text-align: center; margin-bottom: 30px; border-bottom: 2px solid #333; padding-bottom: 15px; }
                    .resume-name { font-size: 28px; font-weight: bold; margin-bottom: 10px; }
                    .resume-contact { font-size: 14px; color: #666; }
                    .section-title { font-size: 18px; font-weight: bold; text-transform: uppercase; border-bottom: 1px solid #ccc; margin: 20px 0 10px 0; padding-bottom: 5px; }
                    .resume-item { margin-bottom: 15px; }
                    .item-title { font-weight: bold; }
                    .item-subtitle { font-style: italic; }
                    .item-date { font-size: 12px; color: #666; }
                `,
                modern: `
                    .template-modern { display: grid; grid-template-columns: 35% 65%; font-family: Arial, sans-serif; }
                    .sidebar { background: #2c3e50; color: white; padding: 30px 20px; }
                    .main { padding: 30px 20px; }
                    .resume-name { font-size: 24px; font-weight: bold; margin-bottom: 10px; }
                    .section-title { font-size: 16px; font-weight: bold; text-transform: uppercase; margin: 20px 0 10px 0; color: #3498db; }
                    .sidebar .section-title { color: white; border-bottom: 1px solid rgba(255,255,255,0.3); padding-bottom: 5px; }
                `,
                creative: `
                    .template-creative { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 40px; }
                    .resume-name { font-size: 32px; font-weight: bold; margin-bottom: 10px; }
                    .section-title { font-size: 18px; font-weight: bold; margin: 20px 0 10px 0; position: relative; }
                    .section-title::after { content: ''; position: absolute; bottom: -3px; left: 0; width: 30px; height: 2px; background: rgba(255,255,255,0.8); }
                `
            };
            
            return css[state.currentTemplate] || css.classic;
        }

        // Sample Data
        function loadSampleData() {
            state.data = {
                personal: {
                    name: 'John Smith',
                    email: 'john.smith@email.com',
                    phone: '+1 (555) 123-4567',
                    linkedin: 'https://linkedin.com/in/johnsmith',
                    github: 'https://github.com/johnsmith',
                    photo: null
                },
                summary: {
                    text: 'Experienced software developer with 5+ years of expertise in full-stack development. Proven track record of delivering scalable web applications and leading cross-functional teams to achieve project goals.'
                },
                experience: [
                    {
                        id: 1,
                        title: 'Senior Software Developer',
                        company: 'Tech Solutions Inc.',
                        startDate: '2021-01',
                        endDate: '',
                        current: true,
                        description: 'Lead development of web applications using React and Node.js',
                        bullets: [
                            'Improved application performance by 40% through code optimization',
                            'Led a team of 4 developers to deliver projects on time',
                            'Implemented CI/CD pipelines reducing deployment time by 60%'
                        ]
                    },
                    {
                        id: 2,
                        title: 'Software Developer',
                        company: 'Digital Agency LLC',
                        startDate: '2019-03',
                        endDate: '2020-12',
                        current: false,
                        description: 'Developed responsive web applications for various clients',
                        bullets: [
                            'Built 15+ responsive websites using modern frameworks',
                            'Collaborated with designers to implement pixel-perfect UIs',
                            'Maintained 99.9% uptime for client applications'
                        ]
                    }
                ],
                education: [
                    {
                        id: 1,
                        degree: 'Bachelor of Science in Computer Science',
                        institution: 'University of Technology',
                        year: '2018',
                        gpa: '3.8',
                        showGpa: true
                    }
                ],
                skills: [
                    { id: 1, name: 'JavaScript', level: 5 },
                    { id: 2, name: 'React', level: 4 },
                    { id: 3, name: 'Node.js', level: 4 },
                    { id: 4, name: 'Python', level: 3 },
                    { id: 5, name: 'SQL', level: 4 },
                    { id: 6, name: 'Git', level: 5 }
                ]
            };
            
            // Reload current section to show sample data
            loadSection(state.currentSection);
            updatePreview();
            updateProgress();
        }

        // Local Storage
        function saveToStorage() {
            localStorage.setItem('resumeBuilderData', JSON.stringify(state.data));
            localStorage.setItem('resumeBuilderTemplate', state.currentTemplate);
        }

        function loadFromStorage() {
            const savedData = localStorage.getItem('resumeBuilderData');
            const savedTemplate = localStorage.getItem('resumeBuilderTemplate');
            
            if (savedData) {
                try {
                    state.data = JSON.parse(savedData);
                } catch (e) {
                    console.error('Error loading saved data:', e);
                }
            }
            
            if (savedTemplate) {
                state.currentTemplate = savedTemplate;
                document.getElementById('templateSelector').value = savedTemplate;
            }
        }

        // Auto-save on page unload
        window.addEventListener('beforeunload', saveToStorage);
    </script>
</body>
</html>
